

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# 1. Load dataset
df = pd.read_csv("sales_data.csv")

# 2. Data Cleaning
df.dropna(inplace=True)  # Remove missing values
df['Order Date'] = pd.to_datetime(df['Order Date'])  # Convert to datetime
df['Month'] = df['Order Date'].dt.month
df['Year'] = df['Order Date'].dt.year

# 3. Summary statistics
print("Dataset Summary:\n", df.describe())

# 4. Total sales by product
product_sales = df.groupby('Product Name')['Sales'].sum().sort_values(ascending=False)
print("\nTop Products:\n", product_sales.head(10))

# 5. Monthly Sales Trend
monthly_sales = df.groupby(['Year', 'Month'])['Sales'].sum().reset_index()

plt.figure(figsize=(10,5))
sns.lineplot(data=monthly_sales, x='Month', y='Sales', hue='Year', marker="o")
plt.title("Monthly Sales Trend")
plt.xlabel("Month")
plt.ylabel("Sales")
plt.legend(title="Year")
plt.savefig("monthly_sales_trend.png")
plt.show()

# 6. Region-wise Sales
region_sales = df.groupby('Region')['Sales'].sum().sort_values(ascending=False)

plt.figure(figsize=(8,5))
sns.barplot(x=region_sales.index, y=region_sales.values, palette="viridis")
plt.title("Region-wise Sales")
plt.xlabel("Region")
plt.ylabel("Total Sales")
plt.savefig("region_sales.png")
plt.show()

# 7. Top Customers by Sales
top_customers = df.groupby('Customer Name')['Sales'].sum().sort_values(ascending=False).head(10)

plt.figure(figsize=(10,5))
sns.barplot(x=top_customers.index, y=top_customers.values, palette="coolwarm")
plt.title("Top 10 Customers by Sales")
plt.xticks(rotation=45)
plt.savefig("top_customers.png")
plt.show()

# 8. Export results
product_sales.to_csv("product_sales_summary.csv")
region_sales.to_csv("region_sales_summary.csv")
monthly_sales.to_csv("monthly_sales_summary.csv")

print("\nAnalysis Completed. Files exported successfully.")
